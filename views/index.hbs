<!--
// Copyright (c) Microsoft Corporation
// All rights reserved.
//
// MIT License:
// Permission is hereby granted, free of charge, to any person obtaining
// a copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to
// permit persons to whom the Software is furnished to do so, subject to
// the following conditions:
//
// The above copyright notice and this permission notice shall be
// included in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED ""AS IS"", WITHOUT WARRANTY OF ANY KIND,
// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
-->

<html>
<head>
    <title>8-Day Shift Scheduling</title>
</head>
<body>
    <div class="container-fluid">
        <div id="instructions">
            <p>Login to begin assigning shifts.</p>
        </div>

        <form class="form-inline" id="days-form" style="display: none">
            <label class="form-check-label" for="inlineFormDays">Assign for this many calendar days:</label>
            <input type="number" class="form-control mb-1 mr-sm-1" id="inlineFormDays" value="90" min="1" max="366" />
        </form>


        <!-- Login button -->
        <img id="btnLogin" style="display: none;" src="/public/images/ms-symbollockup_signin_light.svg" />

        <!-- Result -->
        <div id="divError" style="display: none"></div>

        <div id="shiftForm" style="display: none">
            <table id="teamUsers" class="table table-striped">
                <thead>
                    <tr>
                        <td><strong>Name</strong></td>
                        <td><strong>Alias</strong></td>
                        <td><strong>Assign Shift</strong></td>
                    </tr>
                </thead>
                <tbody></tbody>

            </table>
            <div id="success" class="alert alert-success" style="display: none">Success! The requested shifts have been created as drafts. Go to the Shifts app to view them and share them with the team.</div>
            <div id="progress" class="progress" style="display: none">
                <div id="progressValue" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="100" style="width: 5%"></div>
                <br />
            </div>
            <button id="submit" class="btn btn-default">Submit</button>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.1.1.js" integrity="sha384-VC7EHu0lDzZyFfmjTPJq+DFyIn8TUGAJbEtpXquazFVr00Q/OOx//RjiZ9yU9+9m" crossorigin="anonymous"></script>
    <script src="https://statics.teams.microsoft.com/sdk/v1.2/js/MicrosoftTeams.min.js" integrity="sha384-OncOcMprEYFkUvhe15zi8VdCZIOcuNGnf4ilq2yTfDEjTwPF19V7pZrzxOq/iqt0" crossorigin="anonymous"></script>

    <!-- Check before upgrading your ADAL version, as this sample depends on an internal function to authenticate silently -->
    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/1.0.15/js/adal.min.js" integrity="sha384-lIk8T3uMxKqXQVVfFbiw0K/Nq+kt1P3NtGt/pNexiDby2rKU6xnDY8p16gIwKqgI" crossorigin="anonymous"></script>

    <script type="text/javascript" src="https://unpkg.com/@microsoft/microsoft-graph-client@1.5.2/lib/graph-js-sdk-web.js"></script>

    <script src="https://secure.aadcdn.microsoftonline-p.com/lib/0.2.4/js/msal.min.js"></script>

    <script type="text/javascript" src="/public/javascripts/shiftController.client.js"></script>
</body>
</html>